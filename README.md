# 原神抽卡简单模拟

> 需要安装 [node](https://nodejs.org/) 环境

## 使用

```bash
# 克隆仓库到本地
git clone git@github.com/vikiboss/genshin-gacha

# 进入到目录
cd genshin-gacha

# 安装依赖 (使用阿里源)
npm i --registry=https://registry.npmmirror.com

# 运行代码
node index.js --p up1 --n 50 # 角色 UP 池-1，抽 50 次
node index.js --p up2 --n 50 # 角色 UP 池-2，抽 50 次
node index.js --p wea --n 50 # 武器池，抽 50 次
node index.js --p per --n 50 # 常驻池，抽 50 次
```

如果**当前祈愿池有更新**，或想**自定义祈愿池**，可以按照现有数据格式，修改目录下的 `pool.yaml` 文件即可

## 抽卡机制

抽卡机制参考了:

- [@Pandora Eartha​](https://www.zhihu.com/people/PandoraEartha) 大佬:[一文说清楚原神抽卡机制, 概率, 期望等问题](https://zhuanlan.zhihu.com/p/522246996)
- [@一棵平衡树](https://space.bilibili.com/6165300) 大佬: [原神抽卡全机制总结](https://www.bilibili.com/read/cv10468091)

### UP 池概率机制

#### 五星

在 `[1, 73]` 抽时, 每次出五星角色的概率为 `0.6%` , 在 `[74, 90]` 抽每次抽卡概率比上次高 `6%`.

当获取到五星角色时, 有 `50%` 概率是 UP 角色, 若这次五星没有抽到 UP 角色, 下次五星角色必定是 UP 角色.

五星角色保底为 `90` 抽, 五星 UP 角色保底为 `180` 抽.

#### 四星

在 `[1, 8]` 抽时, 每次出四星角色的概率为 `5.1%` , 在 `[9, 10]` 抽每次抽卡概率比上次高 `51%`.

当获取到四星角色时, 有 `50%` 概率是 UP 角色, 若这次四星没有抽到 UP 角色, 下次四星角色必定是 UP 角色.

四星角色保底为 `10` 抽, 四星 UP 角色保底为 `20` 抽.

### 武器池概率机制

在 `[1, 62]` 抽时, 每次出五星武器的概率为 `0.7%` , 在 `[63, 73]` 抽时每次概率比上次高 `7%`, 在 `[74, 80]` 抽时每次概率比上次高 `3.5%`.

五星 UP 武器占五星武器概率的 `75%`, 由两把 UP 武器共享该 UP 概率.

五星武器保底为 `80` 抽.

五星武器可以定轨, 获取到非定轨的五星武器将获得 `1` 点命定值, 命定值满后(满值为 `2`), 下一把五星武器必定是定轨五星武器. 在命定值未满的过程中或命定值满后抽出定轨武器, 都将重置命定值.

### 常驻池概率机制

#### 五星

在 `[1, 73]` 抽时, 每次出五星的概率为 `0.6%` , 在 `[74, 90]` 抽每次抽卡概率比上次高 `6%`.

五星保底为 `90` 抽.

#### 四星

在 `[1, 8]` 抽时, 每次出四星的概率为 `5.1%` , 在 `[9, 10]` 抽每次抽卡概率比上次高 `51%`.

四星保底为 `10` 抽.
