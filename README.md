# 原神抽卡简单模拟

> 要求配置好 [Git](https://git-scm.com/) 和 [Node.js](https://nodejs.org/) 环境。

## 使用

```bash
# 克隆仓库到本地
git clone git@github.com:vikiboss/genshin-gacha.git

# 进入到目录
cd genshin-gacha

# 安装依赖 (使用阿里源)
npm i --registry=https://registry.npmmirror.com

# 执行抽卡模拟，根据终端提示进行操作
npm start
```

## 抽卡机制

抽卡机制参考：

- [@Pandora Eartha​](https://www.zhihu.com/people/PandoraEartha) 大佬: [一文说清楚原神抽卡机制, 概率, 期望等问题](https://zhuanlan.zhihu.com/p/522246996)
- [@一棵平衡树](https://space.bilibili.com/6165300) 大佬: [原神抽卡全机制总结](https://www.bilibili.com/read/cv10468091)

### UP 池概率机制

#### 五星

在 `[1, 73]` 抽时, 每次出五星的概率为 `0.6%` , 在 `[74, 90]` 抽每次抽卡概率比上次高 `6%`.

当获取到五星时, 有 `50%` 概率是 UP , 若这次五星没有抽到 UP , 下次五星必定是 UP .

五星保底为 `90` 抽, 五星 UP 保底为 `180` 抽.

#### 四星

在 `[1, 8]` 抽时, 每次出四星的概率为 `5.1%` , 在 `[9, 10]` 抽每次抽卡概率比上次高 `51%`.

当获取到四星时, 有 `50%` 概率是 UP , 若这次四星没有抽到 UP , 下次四星必定是 UP .

四星保底为 `10` 抽, 四星 UP 保底为 `20` 抽.

### 武器池概率机制

#### 五星

在 `[1, 62]` 抽时, 每次出五星的概率为 `0.7%` , 在 `[63, 73]` 抽时每次概率比上次高 `7%`, 在 `[74, 80]` 抽时每次概率比上次高 `3.5%`.

五星 UP 占五星概率的 `75%`, 由两把 UP 共享该 UP 概率.

五星保底为 `80` 抽.

五星可以定轨, 获取到非定轨的五星将获得 `1` 点命定值, 命定值满后(满值为 `2`), 下一个五星必定是定轨五星. 在命定值未满的过程中或命定值满后抽出定轨, 都将重置命定值.

#### 四星

在 `[1, 8]` 抽时, 每次出四星的概率为 `6%` , 在 `[9, 10]` 抽每次抽卡概率比上次高 `60%`.

当获取到四星时, 有 `75%` 概率是 UP, 若这次四星没有抽到 UP , 下次四星必定是 UP .

四星保底为 `10` 抽 (其中, 四星概率 `99.3%`, 五星概率 `0.3%`), 四星 UP 保底为 `20` 抽.

### 常驻池概率机制

#### 五星

在 `[1, 73]` 抽时, 每次出五星的概率为 `0.6%` , 在 `[74, 90]` 抽每次抽卡概率比上次高 `6%`.

五星保底为 `90` 抽.

#### 四星

在 `[1, 8]` 抽时, 每次出四星的概率为 `5.1%` , 在 `[9, 10]` 抽每次抽卡概率比上次高 `51%`.

四星保底为 `10` 抽.

## 官方规则详情

### 角色活动祈愿

```plain
「巡御蘙荟」活动祈愿已开启。活动期间内，5星角色「浅蔚轻行·提纳里(草)」以及4星角色「萃念初蘖·柯莱(草)」、「猫尾特调·迪奥娜(冰)」、「断罪皇女！！·菲谢尔(雷)」的祈愿获取概率将大幅提升！

※一般情况下所有角色或武器均适用基础概率，如触发概率UP、保底等以具体规则为准。

〓祈愿规则〓
【5星物品】
在本期「巡御蘙荟」活动祈愿中，5星角色祈愿的基础概率为0.600%，综合概率（含保底）为1.600%，最多90次祈愿必定能通过保底获取5星角色。
当祈愿获取到5星角色时，有50.000%的概率为本期5星UP角色「浅蔚轻行·提纳里(草)」。如果本次祈愿获取的5星角色非本期5星UP角色，下次祈愿获取的5星角色必定为本期5星UP角色。
【4星物品】
在本期「巡御蘙荟」活动祈愿中，4星物品祈愿的基础概率为5.100%，4星角色祈愿的基础概率为2.550%，4星武器祈愿的基础概率为2.550%，4星物品祈愿的综合概率（含保底）为13.000%。最多10次祈愿必定能通过保底获取4星或以上物品，通过保底获取4星物品的概率为99.400%，获取5星物品的概率为0.600%。
当祈愿获取到4星物品时，有50.000%的概率为本期4星UP角色「萃念初蘖·柯莱(草)」、「猫尾特调·迪奥娜(冰)」、「断罪皇女！！·菲谢尔(雷)」中的一个。如果本次祈愿获取的4星物品非本期4星UP角色，下次祈愿获取的4星物品必定为本期4星UP角色。当祈愿获取到4星UP物品时，每个本期4星UP角色的获取概率均等。

获得4星武器时，会同时获得2个无主的星辉作为副产物；获得3星武器时，会同时获得15个无主的星尘作为副产物。

〓若获得重复角色〓
无论通过何种方式（包含但不限于祈愿、商城兑换、系统赠送等）第2~7次获得相同5星角色时，每次将转化为1个对应角色的命星和10个无主的星辉；第8次及之后获得，将仅转化为25个无主的星辉。
无论通过何种方式（包含但不限于祈愿、商城兑换、系统赠送等）第2~7次获得相同4星角色时，每次将转化为1个对应角色的命星和2个无主的星辉；第8次及之后获得，将仅转化为5个无主的星辉。

※本祈愿属于「角色活动祈愿」，「角色活动祈愿」和「角色活动祈愿-2」的祈愿次数保底完全共享，会一直共同累计在「角色活动祈愿」和「角色活动祈愿-2」中，与其他祈愿的祈愿次数保底相互独立计算，互不影响。
```

### 武器活动祈愿

```plain
「神铸赋形」活动祈愿现已开启。活动期间内，限定5星武器「弓·猎人之径」、「长柄武器·贯虹之槊」以及4星武器「单手剑·西风剑」、「双手剑·钟剑」、「长柄武器·西风长枪」、「法器·西风秘典」、「弓·绝弦」的祈愿获取概率将大幅提升！
※以上武器中，限定武器不会进入「奔行世间」常驻祈愿。

※一般情况下所有角色或武器均适用基础概率，如触发概率UP、保底等以具体规则为准。

〓祈愿规则〓
【5星物品】
在本期「神铸赋形」活动祈愿中，5星武器祈愿的基础概率为0.700%，综合概率（含保底）为1.850%，最多80次祈愿必定能通过保底获取5星武器。
当祈愿获取到5星武器时，有75.000%的概率为本期5星UP武器「弓·猎人之径」、「长柄武器·贯虹之槊」中的一个。如果本次祈愿获取的5星武器非本期5星UP武器，下次祈愿获取的5星武器必定为本期5星UP武器。在未通过命定值达到满值获取定轨武器的情况下，当祈愿获取到5星UP物品时，每把本期5星UP武器的获取概率均等。
在本期「神铸赋形」活动祈愿中，可使用「神铸定轨」对本期5星UP武器进行定轨，定轨武器的选择仅在本期「神铸赋形」活动祈愿中生效。
在本期「神铸赋形」活动祈愿中，使用「神铸定轨」定轨武器后，当获取到的5星武器为非当前定轨武器时，获得1点命定值，命定值达到满值后，在本祈愿中获得的下一把5星武器必定为当前定轨武器。获取到当前定轨武器时，无论当前命定值是否达到满值，都将会重置为0，重新累计。
未使用「神铸定轨」定轨武器时，将不会累积命定值。
定轨武器可进行更换或取消。更换或取消当前定轨武器时，命定值将会重置为0，重新累计。
※本祈愿中的命定值仅在本期「神铸赋形」活动祈愿中生效，祈愿结束后命定值将会重置为0，重新累计。
【4星物品】
在本期「神铸赋形」活动祈愿中，4星物品祈愿的基础概率为6.000%，4星角色祈愿的基础概率为3.000%，4星武器祈愿的基础概率为3.000%，4星物品祈愿的综合概率（含保底）为14.500%。最多10次祈愿必定能通过保底获取4星或以上物品，通过保底获取4星物品的概率为99.300%，获取5星物品的概率为0.700%。
当祈愿获取到4星物品时，有75.000%的概率为本期4星UP武器「单手剑·西风剑」、「双手剑·钟剑」、「长柄武器·西风长枪」、「法器·西风秘典」、「弓·绝弦」中的一个。如果本次祈愿获取的4星物品非本期4星UP武器，下次祈愿获取的4星物品必定为本期4星UP武器。当祈愿获取到4星UP物品时，每把本期4星UP武器的获取概率均等。

祈愿获得5星武器时，会同时获得10个无主的星辉作为副产物；获得4星武器时，会同时获得2个无主的星辉作为副产物；获得3星武器时，会同时获得15个无主的星尘作为副产物。

〓若获得重复角色〓
无论通过何种方式（包含但不限于祈愿、商城兑换、系统赠送等）第2~7次获得相同4星角色时，每次将转化为1个对应角色的命星和2个无主的星辉；第8次及之后获得，将仅转化为5个无主的星辉。

※本祈愿属于「武器活动祈愿」，其祈愿次数保底会一直累计在「武器活动祈愿」中，与其他祈愿的祈愿次数保底相互独立计算，互不影响。
```

### 常驻祈愿

```plain
「奔行世间」常驻祈愿为永久性祈愿活动，玩家可以抽取非限定角色与武器。
在本祈愿内，每10次祈愿必会获得至少1个4星或以上物品。

※一般情况下所有角色或武器均适用基础概率，如触发概率UP、保底等以具体规则为准。

〓祈愿规则〓
5星物品祈愿的基础概率为0.600%，5星角色祈愿的基础概率为0.300%，5星武器祈愿的基础概率为0.300%，5星物品祈愿综合概率（含保底）为1.600%，最多90次祈愿必定能通过保底获取5星物品。
4星物品祈愿的基础概率为5.100%，4星角色祈愿的基础概率为2.550%，4星武器祈愿的基础概率为2.550%，4星物品祈愿的综合概率（含保底）为13.000%。最多10次祈愿必定能通过保底获取4星或以上物品，通过保底获取4星物品的概率为99.400%，获取5星物品的概率为0.600%。
祈愿获得5星武器时，会同时获得10个无主的星辉作为副产物；获得4星武器时，会同时获得2个无主的星辉作为副产物；获得3星武器时，会同时获得15个无主的星尘作为副产物。

〓若获得重复角色〓
无论通过何种方式（包含但不限于祈愿、商城兑换、系统赠送等）第2~7次获得相同5星角色时，每次将转化为1个对应角色的命星和10个无主的星辉；第8次及之后获得，将仅转化为25个无主的星辉。
无论通过何种方式（包含但不限于祈愿、商城兑换、系统赠送等）第2~7次获得相同4星角色时，每次将转化为1个对应角色的命星和2个无主的星辉；第8次及之后获得，将仅转化为5个无主的星辉。
```
